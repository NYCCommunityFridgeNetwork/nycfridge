(this.webpackJsonpnycfridge=this.webpackJsonpnycfridge||[]).push([[0],{114:function(e,t,a){e.exports=a(178)},119:function(e,t,a){},122:function(e,t,a){},174:function(e,t,a){},176:function(e,t,a){},178:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),i=a.n(o),c=(a(119),a(20)),l=a(21),d=a(23),s=a(22),u=a(206),m=a(80),g=(a(122),a(52)),f=a.n(g);f.a.initializeApp({apiKey:"AIzaSyCOvDGXIuekFUUzSPh5l1940wCB657NudI",authDomain:"nycfridge-1595334632389.firebaseapp.com",databaseURL:"https://nycfridge-1595334632389.firebaseio.com",projectId:"nycfridge-1595334632389",storageBucket:"nycfridge-1595334632389.appspot.com",messagingSenderId:"1012323391989",appId:"1:1012323391989:web:0326829c1bd942705fe8bc",measurementId:"G-8G077TP9PC"});var p=f.a,h=a(210),b=a(202),E=a(49),v=a(216),C=a(211),O=a(209),k=a(212),j=a(203),y=a(215),F=a(30),I=a(104),S=a.n(I),_=a(84),x=a.n(_),w=function(){return r.a.createElement("div",{className:x.a.Loader},"Loading...")},D=a(50),A=a.n(D),R=a(85),B=a.n(R),L=function(e){return e.display?r.a.createElement("div",{className:B.a.Backdrop,onClick:e.clicked}):null},N=(n.Component,a(43)),G=a(106),T=a(198),H=a(204),M=a(208),z=a(205),U=a(213),K=function(e){var t=Object(n.useState)(""),a=Object(G.a)(t,2),o=a[0],i=a[1];return r.a.createElement(E.a,Object(N.a)({overflow:"auto",pad:"medium",gap:"medium",margin:"medium"},"margin",{bottom:"100px"}),r.a.createElement(T.a,{onSubmit:function(t){return function(t){e.onSubmit(t),e.onClose()}(t.value)}},r.a.createElement(H.a,{name:"name",htmlfor:"textinput-id",label:"Fridge Name"},r.a.createElement(M.a,{id:"textinput-id",name:"name",placeholder:"Community Fridge"})),r.a.createElement(H.a,{name:"streetAddress",htmlfor:"textinput-id",label:"Location"},r.a.createElement(M.a,{id:"textinput-id",name:"streetAddress",placeholder:"Street Address"})),r.a.createElement(H.a,{name:"borough",htmlfor:"textinput-id",label:"Borough"},r.a.createElement(z.a,{name:"borough",options:["Brooklyn","Manhattan","Queens","Bronx","Staten Island"],value:o,onChange:function(e){var t=e.option;return i(t)}})),r.a.createElement(H.a,{name:"neighborhood",htmlfor:"textinput-id",label:"Neighborhood"},r.a.createElement(M.a,{id:"textinput-id",name:"neighborhood",placeholder:"Bushwick"})),r.a.createElement(H.a,{name:"link",htmlfor:"textinput-id",label:"Link/Contact"},r.a.createElement(M.a,{id:"textinput-id",name:"link",placeholder:"Website/Social Media"})),r.a.createElement(H.a,{name:"notes",htmlfor:"textinput-id",label:"Notes"},r.a.createElement(U.a,{id:"textinput-id",name:"notes",placeholder:"type anything else people should know about this fridge!"})),r.a.createElement(E.a,{direction:"row",gap:"medium",pad:{top:"large"}},r.a.createElement(O.a,{label:"close",onClick:e.onClose}),r.a.createElement(O.a,{type:"submit",primary:!0,label:"Submit"}),r.a.createElement(O.a,{type:"reset",label:"Reset"}))))},P=a(5),W=a(99),Y=a.n(W).a.create({baseURL:"https://nycfridge-1595334632389.firebaseio.com/"}),X=a(59),J=a.n(X),V=p.database(),Z=p.storage(),Q=function(e){return{type:"FETCH_FRIDGE_FAIL"}},$=function(e){return{type:"CONFIRM_FRIDGE",id:e}},q=function(e,t,a){var n={name:e.name,notes:e.notes,date:JSON.stringify(new Date)};return function(e){e({type:"CHECK_START"});var r="/fridges/".concat(t.id,"/checks.json");Y.post(r,n).then((function(r){console.log(r.data),e(function(e,t,a){return function(n){Z.ref("images/".concat(e,"/").concat(t)).put(a).on("state_changed",(function(e){}),(function(e){console.log(e)}),(function(){Z.ref("images/".concat(e,"/")).child(t).getDownloadURL().then((function(a){console.log("postCheckImage url",a),V.ref("fridges/".concat(e,"/imageURL")).set(a),n(function(e,t){return{type:"POST_CHECK_IMAGE",url:e,id:t}}(a,t))}))}))}}(t.id,r.data.name,a)),e(function(e,t){return{type:"CHECK_FRIDGE",data:t,id:e}}(r.data.name,n))}))}},ee=a(47),te=a.n(ee),ae=a(42),ne=a(100),re=a.n(ne),oe=a(214),ie=a(60),ce=a.n(ie),le=a(103),de=a.n(le),se=a(101),ue=a.n(se),me=(a(174),function(e){Object(d.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.hover?"brand":"#f4f0ec";return r.a.createElement("div",null,r.a.createElement("div",{className:"popupContainer"},r.a.createElement("div",{className:"popuBubbleAnchor"},r.a.createElement(E.a,{border:"horizontal",pad:"xsmall",background:{color:e},className:"popupBubble"},this.props.fridgeData.name,r.a.createElement("br",null),this.props.fridgeData.streetAddress," ",r.a.createElement("br",null)))))}}]),a}(n.Component)),ge=function(e){var t=e.hover===e.fridgeData.id;return r.a.createElement("div",{className:"pin",onMouseEnter:function(){return e.toggleHover(e.fridgeData.id)},onMouseLeave:function(){return e.toggleHover(e.fridgeData.id)},onClick:function(){return e.onModalOpen(e.fridgeData.id)}},r.a.createElement(ue.a,{className:"pin-icon"}),e.showInfoBox?r.a.createElement(me,{hover:t,fridgeData:e.fridgeData}):null)},fe=(a(176),function(e){Object(d.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).bindResizeListener=function(e,t){t.event.addDomListenerOnce(e,"idle",(function(){e.gestureHandling="greedy"}))},n.handleApiLoaded=function(e,t){console.log("map",e,t),e.gestureHandling="greedy",n.bindResizeListener(e,t)},n.onModalOpen=function(e){n.props.getFridge(e),n.setState({modal:e})},n.modalClosedHandler=function(){n.setState({modal:null})},n.confirmCheck=function(e,t){n.props.onFridgeChecked(e,t,n.state.image),n.setState({checking:!1})},n.getMapLink=function(e){return"https://www.google.com/maps/dir/?api=1&destination=".concat(e.lat,",",e.lng)},n.getChecks=function(e){var t=[];for(var a in e.checks)t.push(Object(P.a)(Object(P.a)({},e.checks[a]),{},{id:a}));return t},n.handleChange=function(e){if(e.target.files[0]){var t=e.target.files[0];n.setState((function(){return{image:t}}))}},n.textInput=r.a.createRef(),n.focusTextInput=n.focusTextInput.bind(Object(ae.a)(n)),n.submitButton=r.a.createRef(),n.state={modal:null,checking:!1,url:"",image:null,progress:0,showInfoBox:!0},n}return Object(l.a)(a,[{key:"focusTextInput",value:function(){this.textInput.current.focus()}},{key:"render",value:function(){var e=this,t=this.props.currentFridge,a=null;if(t){var n,o,i;if(t.confirmed){if(n=r.a.createElement("h4",null,"Status: Confirmed"),o=r.a.createElement(E.a,{pad:{bottom:"large"}},r.a.createElement(O.a,{primary:!0,active:!0,onClick:function(){return e.setState({checking:!0})},label:"Check Fridge"})),t.checks){var c=this.getChecks(t),l=c[c.length-1],d=JSON.parse(l.date),s=l.notes,u=(d=new Date(d)).toLocaleString(),m=t.imageURL?r.a.createElement(oe.a,{fit:"contain",height:"400",width:"250",src:t.imageURL}):null;i=r.a.createElement(E.a,{margin:"small",gap:"xsmall",style:{alignItems:"center"}},r.a.createElement("h3",null,"Last checked: ",u),"Most recent note:  ",s,m)}this.state.checking&&(o=r.a.createElement(E.a,null,r.a.createElement("input",{type:"file",name:"file",id:"file",class:"inputfile",onChange:this.handleChange}),r.a.createElement("label",{for:"file"},"Upload Fridge Picture"),r.a.createElement(T.a,{onSubmit:function(a){return e.confirmCheck(a.value,t)}},r.a.createElement(E.a,{gap:"small"},r.a.createElement(H.a,{htmlFor:"text"},r.a.createElement(M.a,{ref:this.textInput,onClick:this.focusTextInput,size:"small",id:"textinput-id",name:"name",placeholder:"Your Name (optional)"})),r.a.createElement(H.a,{name:"notes",label:"Notes",htmlFor:"text-area",ref:this.textInput,component:U.a,placeholder:"leave your notes about this check-in here!"}),r.a.createElement(E.a,{direction:"row",gap:"xsmall"},r.a.createElement(O.a,{size:"small",active:!0,label:"Cancel",onClick:function(){return e.setState({checking:!1})}}),r.a.createElement(O.a,{ref:this.submitButton,size:"small",type:"submit",primary:!0,label:"Submit Check"}))))))}else n=r.a.createElement(E.a,null,r.a.createElement("h4",null,"Status: Unconfirmed"),r.a.createElement(O.a,{primary:!0,active:!0,onClick:function(){return e.props.onFridgeConfirmed(t)},label:"Confirm Fridge"}));a=r.a.createElement(E.a,{align:"center",margin:"medium",pad:"medium",overflow:"hidden"},r.a.createElement("h2",null,t.name),r.a.createElement("h2",null,"Neighborhood: ",t.neighborhood),r.a.createElement("h3",null,"Location: ",r.a.createElement(y.a,{href:this.getMapLink(t)},t.streetAddress,r.a.createElement(de.a,null))),r.a.createElement("h3",null,"Notes: ",t.notes),r.a.createElement(O.a,{href:t.link,label:"Social Media"}),n,i,o)}return r.a.createElement(E.a,{className:"google-map"},this.state.modal&&r.a.createElement(h.a,{full:"vertical",onClickOutside:this.modalClosedHandler},r.a.createElement(E.a,{overflow:"hidden",width:"large"},r.a.createElement(E.a,{flex:!1,pad:{horizontal:"medium"},align:"center",direction:"row",tag:"header",justify:"between",style:{position:"relative"}},r.a.createElement(v.a,{level:4},r.a.createElement("strong",null,r.a.createElement(O.a,{plain:!0,size:"large",alignSelf:"start",onClick:this.modalClosedHandler,label:"Back To Map",icon:r.a.createElement(ce.a,{fontSize:"large"})})))),r.a.createElement(E.a,{flex:!0,align:"center",background:"light-1",overflow:"auto"},r.a.createElement(E.a,{flex:!1,background:"white"},a,r.a.createElement(O.a,{alignSelf:"center",margin:"medium",onClick:this.modalClosedHandler,label:"Back To Map",icon:r.a.createElement(ce.a,null)}))))),r.a.createElement(re.a,{bootstrapURLKeys:{key:"AIzaSyCOvDGXIuekFUUzSPh5l1940wCB657NudI"},defaultCenter:this.props.location,defaultZoom:this.props.zoomLevel,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:function(t){var a=t.map,n=t.maps;return e.handleApiLoaded(a,n)}},this.props.fridges.map((function(t){return r.a.createElement(ge,{lat:t.lat,lng:t.lng,fridgeData:t,showInfoBox:e.props.showInfoBox,toggleHover:e.props.toggleHover,hover:e.props.hover,onModalOpen:e.onModalOpen})}))))}}]),a}(n.Component)),pe=Object(F.b)((function(e){return{currentFridge:e.currentFridge}}),(function(e){return{getFridge:function(t){return e(function(e){return function(t){var a="/fridges/".concat(e,".json");Y.get(a).then((function(a){var n=Object(P.a)(Object(P.a)({},a.data),{},{id:e});console.log(n),t({type:"GET_FRIDGE",data:n})})).catch((function(e){console.log(e)}))}}(t))},onFridgeConfirmed:function(t){return e(function(e){var t=Object(P.a)(Object(P.a)({},e),{},{confirmed:!0});return function(a){var n="/fridges/".concat(e.id,".json");Y.put(n,t).then((function(t){console.log(t.data),a($(e.id))}))}}(t))},onFridgeChecked:function(t,a,n){return e(q(t,a,n))},getFridgeChecks:function(t){return e(function(e){return function(t){var a="/fridges/".concat(e,"/checks.json");Y.get(a).then((function(e){t({type:"GET_FRIDGE_CHECKS",data:e.data})}))}}(t))}}}))(fe),he=function(e){Object(d.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onModalOpen=function(){n.setState({modal:!0})},n.modalClosedHandler=function(){n.setState({modal:!1})},n.toggleHover=function(e){var t=n.state.hover===e?null:e;n.setState({hover:t})},n.fridgeAdded=function(e){n.props.onFridgeAdded(e)},n.addFridge=function(){n.onModalOpen()},n.state={location:{address:"252 Broadway Brooklyn NY 11211",lat:40.7,lng:-73.9},hover:null,modal:!1,url:"",image:null,progress:0,showInfoBox:!0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.onFridgesLoad()}},{key:"render",value:function(){var e=this,t=r.a.createElement(w,null),a=r.a.createElement(w,null);return this.props.fridges&&(t=r.a.createElement(pe,{location:this.state.location,zoomLevel:12,toggleHover:this.toggleHover,hover:this.state.hover,showInfoBox:this.state.showInfoBox,fridges:this.props.fridges}),a=r.a.createElement(h.a,{modal:!0,animation:"fadeIn",onEsc:this.modalClosedHandler,onClickOutside:this.modalClosedHandler},r.a.createElement(K,{onClose:this.modalClosedHandler,onSubmit:this.fridgeAdded}))),r.a.createElement("div",{className:te.a.Container},r.a.createElement("div",{className:te.a.contentWrap},r.a.createElement(b.a,{background:"light-4",pad:"xsmall",justify:"center"},r.a.createElement(E.a,{gap:"small",alignSelf:"center"},r.a.createElement(v.a,{level:"3"},"NYC Community Fridges"),r.a.createElement(C.a,null,"Current Fridge Count : ",this.props.fridges.length))),r.a.createElement(E.a,{justify:"center",direction:"row",pad:"xsmall",gap:"small"},r.a.createElement(O.a,{primary:!0,label:"Add Fridge",active:!0,onClick:this.addFridge}),r.a.createElement(k.a,{name:"toggle",toggle:!0,checked:this.state.showInfoBox,label:"Show Fridge Info Boxes",onChange:function(t){return e.setState({showInfoBox:t.target.checked})}})),this.state.modal&&a,t),r.a.createElement(j.a,{className:te.a.Footer,justify:"center",background:"dark-2",pad:{horizontal:"large",vertical:"small"}},r.a.createElement(E.a,{height:"xxsmall"},r.a.createElement(C.a,{size:"xsmall",textAlign:"center"},"Fridges are set up and maintained by mutual aid organizations and volunteers, aided by ",r.a.createElement(y.a,{href:"https://www.instagram.com/iohnyc/"},"IOHNYC.")," Feed people not landfills, food sovereignty for all. "),r.a.createElement(C.a,{size:"xsmall",textAlign:"center"},"Site built using ",r.a.createElement(y.a,{href:"https://reactjs.org/"},"React, ")," UI components from ",r.a.createElement(y.a,{href:"https://v2.grommet.io/"},"Grommet.io. ")," Source code: ",r.a.createElement(y.a,{icon:r.a.createElement(S.a,{fontSize:"small"}),href:"https://github.com/marsbtyne/nycfridge"})))))}}]),a}(n.Component),be=Object(F.b)((function(e){return{fridges:e.fridges,loading:e.loading}}),(function(e){return{onFridgesLoad:function(){return e((function(e){e({type:"FETCH_FRIDGE_START"}),Y.get("/fridges.json").then((function(t){var a=[];for(var n in t.data)a.push(Object(P.a)(Object(P.a)({},t.data[n]),{},{id:n}));console.log(a),e({type:"LOAD_FRIDGES",data:a})})).catch((function(e){}))}))},onFridgeAdded:function(t){return e((a=t,function(e){e({type:"ADD_FRIDGE_START"});var t=a;J.a.setApiKey("AIzaSyCOvDGXIuekFUUzSPh5l1940wCB657NudI");var n=a.streetAddress.concat(" ",a.borough," NY");console.log(n),J.a.fromAddress(n).then((function(n){var r=n.results[0].geometry.location,o=r.lat,i=r.lng;console.log(o,i),t=Object(P.a)(Object(P.a)({},a),{},{lat:o,lng:i}),console.log("with coords",t),Y.post("/fridges.json",t).then((function(a){var n;e((n=a.data.name,{type:"ADD_FRIDGE",data:t,id:n}))})).catch((function(t){e(Q(t))}))})).catch((function(e){}))}));var a}}}))(he),Ee=function(e){Object(d.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m.a,null,r.a.createElement("title",null,"Map of NYC Community Fridges"),r.a.createElement("meta",{name:"description",content:"Map of free community fridges and food shares across New York City"})),r.a.createElement(u.a,null,r.a.createElement(be,null)))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ve=a(31),Ce=a(105),Oe={fridges:[],loading:!1,submitted:!1,currentFridge:null},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_FRIDGE_START":return Object(P.a)(Object(P.a)({},e),{},{loading:!0});case"LOAD_FRIDGES":return Object(P.a)(Object(P.a)({},e),{},{fridges:t.data,loading:!1});case"GET_FRIDGE":return Object(P.a)(Object(P.a)({},e),{},{currentFridge:t.data,loading:!1});case"ADD_FRIDGE_START":return Object(P.a)(Object(P.a)({},e),{},{loading:!0,submitted:!1});case"CHECK_START":return Object(P.a)(Object(P.a)({},e),{},{loading:!0});case"ADD_FRIDGE":var a=Object(P.a)(Object(P.a)({},t.data),{},{id:t.id,confirmed:!1});return Object(P.a)(Object(P.a)({},e),{},{fridges:e.fridges.concat(a),loading:!1,submitted:!0});case"POST_CHECK_IMAGE":return Object(P.a)(Object(P.a)({},e),{},{currentFridge:Object(P.a)(Object(P.a)({},e.currentFridge),{},{imageURL:t.url}),loading:!1});case"CHECK_FRIDGE":var n=e.currentFridge;n.checks||(n.checks={}),n.checks[t.id]=t.data;Object(P.a)(Object(P.a)({},t.data),{},{id:t.id});return Object(P.a)(Object(P.a)({},e),{},{currentFridge:Object(P.a)(Object(P.a)({},n),{},{lastCheck:t.id})});case"GET_FRIDGE_CHECKS":return Object(P.a)(Object(P.a)({},e),{},{currentFridge:Object(P.a)(Object(P.a)({},e.currentFridge),{},{checks:t.data})});case"CONFIRM_FRIDGE":var r=e.fridges,o=r.map((function(e){return e.id===t.id&&(e.confirmed=!0),e}));return Object(P.a)(Object(P.a)({},e),{},{fridges:o,currentFridge:Object(P.a)(Object(P.a)({},e.currentFridge),{},{confirmed:!0})});default:return e}},je=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ve.c,ye=Object(ve.d)(ke,je(Object(ve.a)(Ce.a))),Fe=r.a.createElement(F.a,{store:ye},r.a.createElement(Ee,null));i.a.render(Fe,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},47:function(e,t,a){e.exports={Container:"container_Container__3I_BF",contentWrap:"container_contentWrap__1Vay0",Footer:"container_Footer__3BZWd"}},50:function(e,t,a){},84:function(e,t,a){e.exports={Loader:"Spinner_Loader__3K0zH",load1:"Spinner_load1__2AjVX"}},85:function(e,t,a){e.exports={Backdrop:"Backdrop_Backdrop__3_tKW"}}},[[114,1,2]]]);
//# sourceMappingURL=main.37c7068e.chunk.js.map